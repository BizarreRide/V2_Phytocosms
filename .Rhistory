qqnorm(z.soil[,i], xlab=colnames(z.soil[i]))
qqline(z.soil[,i])
}
View(z.soil)
for (i in 1:7) {
qqnorm(z.soil[,i], xlab=colnames(z.soil[i]))
qqline(z.soil[,i])
}
par(mfrow=c(3,3))
for (i in 1:7) {
qqnorm(z.soil[,i], xlab=colnames(z.soil[i]))
qqline(z.soil[,i])
}
par(mfrow=c(3,3))
for (i in 1:7) {
hist(z.soil[,i], xlab=colnames(z.soil[i]))
}
x.soil <- soil+1
View(x.soil)
leaching.melt <- melt(leaching, id.vars=c(1:7))
leaching.melt <-concat.split.multiple(leaching.melt, "variable", ".")
leaching2 <- leaching.melt[!(leaching.melt$variable_2==1),]
ggplot(leaching2, aes(x=variable_2, y=value, col=treat), labeller=label_parsed) +
geom_point(lwd=2) +
ylab(expression(paste("?????"))) +
xlab("sampling dates") +
ggtitle(expression(paste("Percolation Water"))) +
facet_grid(variable_1+plant~soil, labeller=label_parsed) +
mytheme + theme(legend.position="bottom")
library(splitstackshape)
leaching.melt <- melt(leaching, id.vars=c(1:7))
leaching.melt <-concat.split.multiple(leaching.melt, "variable", ".")
leaching2 <- leaching.melt[!(leaching.melt$variable_2==1),]
ggplot(leaching2, aes(x=variable_2, y=value, col=treat), labeller=label_parsed) +
geom_point(lwd=2) +
ylab(expression(paste("?????"))) +
xlab("sampling dates") +
ggtitle(expression(paste("Percolation Water"))) +
facet_grid(variable_1+plant~soil, labeller=label_parsed) +
mytheme + theme(legend.position="bottom")
View(soil)
soil$NO3 <- soil$NO3*(-1)
View(soil)
plot(full.frame$NH4)
par(mfrow=c(1,1))
plot(full.frame$NH4)
plot(sqrt(full.frame$NH4))
plot(log(full.frame$NH4))
min(full.frame$NH4)
soil$NH4 <- soil$NH4 + min(full.frame$NH4)
plot(full.frame$NH4)
min(soil$NH4)
plot(soil$NH4)
soil$NH4 <- soil$NH4 + abs(min(full.frame$NH4))
soil <- full.frame[,12:18]
soil$NO3 <- soil$NO3*(-1)
soil$NH4 <- soil$NH4 + abs(min(full.frame$NH4))
plot(soil$NH4)
soil.log <- data.frame(log(soil))
View(soil.log)
View(soil)
soil$NO3 <- soil$NO3*(-1)
for (i in 1:7) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
soil <- full.frame[,12:18]
bio <- full.frame[,8:12]
groups <- full.frame[,1:7]
# Z-transformation
soil$NO3 <- soil$NO3*(-1)
for (i in 1:7) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
View(soil)
soil.log <- log(soil)
soil.z <- data.frame(scale(soil))
par(mfrow=c(3,3))
for (i in 1:7) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(3,3))
for (i in 1:7) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
soil.z <- data.frame(scale(soil.log))
# Test for normal distribution
par(mfrow=c(3,3))
for (i in 1:7) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(3,3))
for (i in 1:7) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
soil <- full.frame[,12:18]
bio <- full.frame[,8:12]
groups <- full.frame[,1:7]
# Z-transformation
soil$NO3 <- soil$NO3*(-1)
for (i in 1:7) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
soil.log <- log(soil)
soil.z <- data.frame(scale(soil.log))
View(z.soil)
par(mfrow=c(3,3))
for (i in 1:7) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(3,3))
for (i in 1:7) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
par(mfrow=c(3,3))
for (i in 1:7) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
View(soil.z)
soil <- full.frame[,12:18]
bio <- full.frame[,8:12]
groups <- full.frame[,1:7]
# Z-transformation
soil$NO3 <- soil$NO3*(-1)
for (i in 1:7) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
soil.log <- log(soil)
View(soil.log)
soil.log <- log1p(soil)
soil.z <- data.frame(scale(soil.log))
View(soil.z)
View(soil.log)
soil.log <- log1p(soil)
soil <- full.frame[,12:18]
bio <- full.frame[,8:12]
groups <- full.frame[,1:7]
# Z-transformation
soil$NO3 <- soil$NO3*(-1)
for (i in 1:7) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
soil.log <- log1p(soil)
soil.z <- data.frame(scale(soil.log))
View(soil.z)
View(soil.log)
par(mfrow=c(3,3))
for (i in 1:7) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(3,3))
for (i in 1:7) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
View(full.frame)
full.frame <- full.frame[-11,]
soil <- full.frame[,12:18]
bio <- full.frame[,8:12]
groups <- full.frame[,1:7]
# Z-transformation
soil$NO3 <- soil$NO3*(-1)
for (i in 1:7) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
soil.log <- log1p(soil)
soil.z <- data.frame(scale(soil.log))
# Test for normal distribution
par(mfrow=c(3,3))
for (i in 1:7) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(3,3))
for (i in 1:7) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
soil.mnorm <- t(z.soil)
mshapiro.test(soil.mnorm) # NO Normal Distribution!!!!!
soil.mnorm <- t(soil.z)
mshapiro.test(soil.mnorm) # NO Normal Distribution!!!!!
pca.data <- rda(soil.z)
summary(pca.data)
scores(pca.data, choices = 1:4, display = "species", scaling = 0)
plot(pca.data)
plot(pca.data, scal = 1)
par(mfrow=c(1,1))
par(mfrow=c(1,1))
plot(pca.data)
summary(pca.data)
plot(pca.data, scal = 1)
plot(pca.data, scale = 1)
biplot.rda(soil.pca, scaling=1, main="PCA - scaling1")
dev.off()
biplot.rda(soil.pca, scaling=1, main="PCA - scaling1")
?biplot.rda()
library(vegan)
biplot.rda(soil.pca, scaling=1, main="PCA - scaling1")
vegan::biplot.rda(soil.pca, scaling=1, main="PCA - scaling1")
biplot(soil.pca, scaling=1, main="PCA - scaling1")
soil.pca <- rda(soil.z)
summary(soil.pca)
# Loads of variables:
scores(soil.pca, choices = 1:4, display = "species", scaling = 0)
par(mfrow=c(1,1))
plot(pca.data)
plot(pca.data, scale = 1)
biplot(soil.pca, scaling=1, main="PCA - scaling1")
biplot(soil.pca, scaling=2, main="PCA - scaling1")
source("Analysis/evplot.R")
par(mfrow=c(1,1))
biplot(soil.pca, scaling=2, main="PCA - Scaling 2")
ev <- soil.pca$CA$eig
evplot(ev)
source("Analysis/cleanplot.pca.R")
cleanplot.pca(soil.pca, point=TRUE)
source("Analysis/cleanplot.pca.R")
cleanplot.pca(soil.pca, point=TRUE)
soil.pca <- rda(soil.z, scale=FALSE)
summary(soil.pca)
par(mfrow=c(1,1))
biplot(soil.pca, scaling=2, main="PCA - Scaling 2")
cleanplot.pca(soil.pca, point=TRUE)
cleanplot.pca(soil.pca)
par(mfrow=c(1,2))
cleanplot.pca(soil.pca)
scores(soil.pca, choices = 1:4, display = "species", scaling = 0)
par(mfrow=c(1,2))
biplot(soil.pca, scaling=1, main="PCA - Scaling 2")
biplot(soil.pca, scaling=2, main="PCA - Scaling 2")
par(mfrow=c(1,2))
biplot(soil.pca, scaling=1, main="PCA - Scaling 1")
biplot(soil.pca, scaling=2, main="PCA - Scaling 2")
View(full.frame)
soil <- full.frame[,c(12,14:18]
soil <- full.frame[,c(12,14:18)]
soil$NO3 <- soil$NO3*(-1)
for (i in 1:7) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
soil.log <- log1p(soil)
soil.z <- data.frame(scale(soil.log))
soil$NO3 <- soil$NO3*(-1)
for (i in 1:6) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
soil.log <- log1p(soil)
soil.z <- data.frame(scale(soil.log))
soil <- full.frame[,c(12,14:18)]
bio <- full.frame[,8:12]
groups <- full.frame[,1:7]
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Z-transformation ####
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
soil$NO3 <- soil$NO3*(-1)
for (i in 1:6) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
soil.log <- log1p(soil)
soil.z <- data.frame(scale(soil.log))
par(mfrow=c(3,3))
for (i in 1:7) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(3,3))
for (i in 1:7) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
soil.mnorm <- t(soil.z)
mshapiro.test(soil.mnorm) # NO Normal Distribution!!!!!
par(mfrow=c(2,3))
for (i in 1:6) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(2,3))
for (i in 1:6) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
soil.mnorm <- t(soil.z)
mshapiro.test(soil.mnorm) # NO Normal Distribution!!!!!
soil.pca <- rda(soil.z, scale=FALSE)
scores(soil.pca, choices = 1:4, display = "species", scaling = 0)
summary(soil.pca)
ev <- soil.pca$CA$eig
evplot(ev)
par(mfrow=c(1,2))
biplot(soil.pca, scaling=1, type="points", main="PCA - Scaling 1")
biplot(soil.pca, scaling=2, type="points", main="PCA - Scaling 2")
?biplot()
par(mfrow=c(1,2))
biplot(soil.pca, scaling=1,  main="PCA - Scaling 1")
biplot(soil.pca, scaling=2,  main="PCA - Scaling 2")
pl <- biplot(soil.pca, type = "points")
identify(pl,"sp", plot=TRUE, atpen=TRUE, labels=names(data), cex=1.0)
identify(pl,"sp", plot=TRUE, atpen=TRUE, labels=names(soil.z), cex=1.0)
par(mfrow=c(1,1))
pl <- biplot(soil.pca, type = "points")
identify(pl,"sp", plot=TRUE, atpen=TRUE, labels=names(soil.z), cex=1.0)
points(pl, "sites", pch=25, bg=groups$soil, cex=0.7)
points(pl, "sites", pch=25, bg=groups$treat, cex=0.7)
points(pl, "sites", pch=25, bg=groups$Lt, cex=0.7)
bio <- full.frame[,c(8:12,14:18)]
soil <- full.frame[,c(8:12,14:18)]
soil$NO3 <- soil$NO3*(-1)
for (i in 1:6) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
soil.log <- log1p(soil)
soil.z <- data.frame(scale(soil.log))
soil$NO3 <- soil$NO3*(-1)
for (i in 1:10) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
soil.log <- log1p(soil)
soil.z <- data.frame(scale(soil.log))
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Test for normal distribution ####
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
par(mfrow=c(3,4))
for (i in 1:10) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(3,4))
for (i in 1:10) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
soil.mnorm <- t(soil.z)
mshapiro.test(soil.mnorm) # NO Normal Distribution!!!!!
soil <- full.frame[,c(8:12,14:18)]
soil$NO3 <- soil$NO3*(-1)
for (i in 1:10) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
soil.log <- log1p(soil)
soil.z <- data.frame(scale(soil.log))
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Test for normal distribution ####
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
par(mfrow=c(3,4))
for (i in 1:10) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(3,4))
for (i in 1:10) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
soil.mnorm <- t(soil.z)
mshapiro.test(soil.mnorm) # NO Normal Distribution!!!!!
soil <- full.frame[,c(8:12,14:18)]
soil$NO3 <- soil$NO3*(-1)
for (i in 1:10) {
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
View(soil)
soil <- full.frame[,c(8:12,14:18)]
str(soil)
na.option=na.omit()
?Na.option
na.option
?na.option
is.na(soil)
is.na(soil) <- 0
soi[is.na(soil),] <- 0
soil[is.na(soil),] <- 0
soil[,is.na(soil)] <- 0
is.na(soil) <- "k"
soil <- full.frame[,c(8:12,14:18)]
is.na(soil) <- "0"
str(soil)
is.na(soil)
summary(soil)
soil <- full.frame[,c(8:12,14:18)]
summary(soil)
soil <- full.frame[,c(8:12,14:18)]
soil$NO3 <- soil$NO3*(-1)
for (i in 1:10) {
na.sction=na.omit()
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
View(soil)
soil <- full.frame[,c(8:12,14:18)]
soil1 <- full.frame[,c(8:12,14:18)]
soil$NO3 <- soil$NO3*(-1)
for (i in 1:10) {
#na.sction=na.omit()
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
View(soil1)
View(soil)
soil <- full.frame[,c(8:12,14:18)]
soil$NO3 <- soil$NO3*(-1)
for (i in 1:10) {
na.sction=na.omit()
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
View(soil)
View(soil1)
View(soil)
View(soil1)
View(soil)
soil <- full.frame[,c(8:12,14:18)]
soil$NO3 <- soil$NO3*(-1)
for (i in 1:10) {
na.sction=na.pass()
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
View(soil)
View(soil1)
soil <- full.frame[,c(8:12,14:18)]
soil$NO3 <- soil$NO3*(-1)
for (i in 1:10) {
na.action=na.pass()
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
View(soil)
View(soil1)
View(soil)
soil <- full.frame[,c(8:12,14:18)]
for (i in 1:10) {
na.action=na.pass(soil)
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
View(soil)
soil <- full.frame[,c(8:12,14:18)]
soil$NO3 <- soil$NO3*(-1)
for (i in 1:10) {
na.action=na.omit(soil)
soil[,i] <- soil[,i] + abs(min(soil[,i]))
}
View(soil)
for (i in 1:10) {
na.action=na.omit(soil)
soil[,i] <- soil[,i] + abs(min(soil[,i], na.omit))
}
?min()
soil <- full.frame[,c(8:12,14:18)]
for (i in 1:10) {
na.action=na.omit(soil)
soil[,i] <- soil[,i] + abs(min(soil[,i], na.rm=TRUE))
}
View(soil)
View(soil1)
View(soil)
soil.log <- log1p(soil)
View(soil.log)
soil.z <- data.frame(scale(soil.log))
View(soil.z)
par(mfrow=c(3,4))
for (i in 1:10) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(3,4))
for (i in 1:10) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
identify()
locator()
?identify()
View(soil.z)
summary(soil.z)
soil.mnorm <- t(soil.z)
mshapiro.test(soil.mnorm) # NO Normal Distribution!!!!!
mshapiro.test(soil.mnorm, na.rm=TRUE) # NO Normal Distribution!!!!!
?mshapiro.test()
soil.pca <- rda(soil.z, scale=FALSE)
is.na(soil.z)
soil.z[is.na(soil.z)] <- 0
soil.pca <- rda(soil.z, scale=FALSE)
summary(soil.pca)
scores(soil.pca, choices = 1:4, display = "species", scaling = 0)
par(mfrow=c(1,2))
biplot(soil.pca, scaling=1,  main="PCA - Scaling 1")
biplot(soil.pca, scaling=2,  main="PCA - Scaling 2")
par(mfrow=c(1,1))
pl <- biplot(soil.pca, type = "points")
points(pl, "sites", pch=25, bg=groups$Lt, cex=0.7)
points(pl, "sites", pch=25, bg=groups$treat, cex=0.7)
points(pl, "sites", pch=25, bg=groups$soil, cex=0.7)
points(pl, "sites", pch=25, bg=groups$col, cex=0.7)
View(groups)
points(pl, "sites", pch=25, bg=groups$Fc, cex=0.7)
points(pl, "sites", pch=25, bg=groups$plant, cex=0.7)
points(pl, "sites", pch=25, bg=groups$soil, cex=0.7)
points(pl, "sites", pch=25, bg=interaction(groups$soil, goups$plant), cex=0.7)
points(pl, "sites", pch=25, bg=interaction(groups$soil, groups$plant), cex=0.7)
identify(pl,"sp", plot=TRUE, atpen=TRUE, labels=names(soil.z), cex=1.0)
env <- full.frame[,c(8:12,14:18)]
rda(env, scale=TRUE)
summary(soil.pca, scaling=1)
eigenvalues <- soil.pca$CA$eig
evplot(eigenvalues) # One interprets only the axes whose eigenvalues are larger than the length of corresponding piece of the sticks
?biplot()
par(mfrow=c(1,2))
biplot(soil.pca, scaling=1,  main="PCA - Scaling 1")
source("Analysis/cleanplot.pca.R")
cleanplot.pca(soil.pca, ahead=0)
cleanplot.pca
par(mfrow=c(1,2))
biplot(soil.pca, scaling=1,  main="PCA - Scaling 1")
biplot(soil.pca, scaling=2,  main="PCA - Scaling 2")
pcacircle(soil.pca)
biplot(soil.pca, scaling=1,  main="PCA - Scaling 1")
pcacircle(soil.pca)
biplot(soil.pca, scaling=2,  main="PCA - Scaling 2")
