soil.mnorm <- t(soil.z)
mshapiro.test(soil.mnorm) # NO Normal Distribution!!!!!
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
soil.z[is.na(soil.z)] <- 0
# PCA
soil.pca <- rda(soil.z, scale=FALSE)
summary(soil.pca)
summary(soil.pca, scaling=1)
# Inertia: in vegan's language this is the term for "variation" in the data. This term comes from the word of CA (Sect. 5.4).
# In PCA, the "inertia" is either the sum of the variances of the variables (PCA on a covariance matrix) or the sum of the diagonal values
# of the correlation matrix (PCA on a correlation matrix), i.e. the sum of all correlations of the variables with themselves,
# which corresponds to the number of variables.
# Constrained and unconstrained (constrained = gezwungen, abhängig): In PCA the  analysis is unconstrained and so are the results.
# Eigenvalues: symbolized as lambda, these are measures of the importance of an axis. By dividing them by the total inertia, they can be expressed as
# Proportion explained / proportion of variation accounted for
# Scaling: 1 = distance biplot: the eigenvectors are scaled to unit length. (1) Distances among objects in the biplot are approximations
# of their Euclidean distances in multidimensional space. (2) The angles among descriptor vectors are meaningless
#          2 = correlation biplot: ech eigenvector is scaled to the squareroot of the eigenvalue. (1) Distances among objects are not
# approximations of their Euclidean distances in multidimensional space. (2) The angles between descriptors  in the biplot reflect their
# correlations
# Species scores: coordinates of the arrow heads of the variables. For historical rasons response variables are always calles "species" in vegan
# Site scores: coordinates of the sites in the ordination diagram. Objects are always called "Sites" in vegan output files.
# Loads of variables:
scores(soil.pca, choices = 1:4, display = "species", scaling = 0)
# Biplot
source("Analysis/evplot.R")
source("Analysis/cleanplot.pca.R")
eigenvalues <- soil.pca$CA$eig
evplot(eigenvalues) # One interprets only the axes whose eigenvalues are larger than the length of corresponding piece of the sticks
par(mfrow=c(1,2))
biplot(soil.pca, scaling=1,  main="PCA - Scaling 1")
pcacircle(soil.pca)
biplot(soil.pca, scaling=2,  main="PCA - Scaling 2")
# Interpretation ####
# The Proportion of variance accounted for by the first two axes is 0.7375 or 73.8% This high value makes us confident
# that our interpretation of the first pair of axes extracts most relevant information from the data.
# First, the scaling 1 biplot displays a feature that must be explained. The circle is called a circle of equilibrium contribution. Its radius is equal to sqrt(d/p),
# where d is the number of axes represented in the biplot (usually d=2) and p is the number of dimensions of the PCA space (i.e. the number of variables of the data matrix,
#                                                                                                                          6 in this case)
# The radius of this circle represents the length of the vector representing a variable that contributes equally to all the dimanesions of the PCA space. Therefore,
# for any given pair of axis the variables that have vectors longer than this radius make a higher contribution than average and can be interpreted with confidence.
# The top right quarter of the biplot scaling 1 shows Microcosms with the highest values for pH, C and N content of the soil
# The scaling 2 biplot shows, that variables NO3 and nH4 are highly negatively correlated, as well as Cmic and No3. N, C and pH have nearly othogonal arrows indicating
# a correlation close to 0.
#####
full.frame <- full.frame[-11,]
# Divide data frame in subsets ####
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
soil <- full.frame[,c(12,14:18)]
colnames(soil)[2:3] <- c("carbon","Nitrogen")
bio <- full.frame[,8:12]
env <- full.frame[,c(8:12,14:18)]
groups <- full.frame[,1:7]
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Z-transformation ####
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
soil$NO3 <- soil$NO3*(-1)
for (i in 1:6) {
na.action=na.omit(soil)
soil[,i] <- soil[,i] + abs(min(soil[,i], na.rm=TRUE))
}
soil.log <- log1p(soil)
soil.z <- data.frame(scale(soil.log))
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Test for normal distribution ####
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
par(mfrow=c(3,4))
for (i in 1:6) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(3,4))
for (i in 1:6) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
summary(soil.z)
soil.mnorm <- t(soil.z)
mshapiro.test(soil.mnorm) # NO Normal Distribution!!!!!
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
soil.z[is.na(soil.z)] <- 0
# PCA
soil.pca <- rda(soil.z, scale=FALSE)
summary(soil.pca)
summary(soil.pca, scaling=1)
# Inertia: in vegan's language this is the term for "variation" in the data. This term comes from the word of CA (Sect. 5.4).
# In PCA, the "inertia" is either the sum of the variances of the variables (PCA on a covariance matrix) or the sum of the diagonal values
# of the correlation matrix (PCA on a correlation matrix), i.e. the sum of all correlations of the variables with themselves,
# which corresponds to the number of variables.
# Constrained and unconstrained (constrained = gezwungen, abhängig): In PCA the  analysis is unconstrained and so are the results.
# Eigenvalues: symbolized as lambda, these are measures of the importance of an axis. By dividing them by the total inertia, they can be expressed as
# Proportion explained / proportion of variation accounted for
# Scaling: 1 = distance biplot: the eigenvectors are scaled to unit length. (1) Distances among objects in the biplot are approximations
# of their Euclidean distances in multidimensional space. (2) The angles among descriptor vectors are meaningless
#          2 = correlation biplot: ech eigenvector is scaled to the squareroot of the eigenvalue. (1) Distances among objects are not
# approximations of their Euclidean distances in multidimensional space. (2) The angles between descriptors  in the biplot reflect their
# correlations
# Species scores: coordinates of the arrow heads of the variables. For historical rasons response variables are always calles "species" in vegan
# Site scores: coordinates of the sites in the ordination diagram. Objects are always called "Sites" in vegan output files.
# Loads of variables:
scores(soil.pca, choices = 1:4, display = "species", scaling = 0)
# Biplot
source("Analysis/evplot.R")
source("Analysis/cleanplot.pca.R")
eigenvalues <- soil.pca$CA$eig
evplot(eigenvalues) # One interprets only the axes whose eigenvalues are larger than the length of corresponding piece of the sticks
par(mfrow=c(1,2))
biplot(soil.pca, scaling=1,  main="PCA - Scaling 1")
pcacircle(soil.pca)
biplot(soil.pca, scaling=2,  main="PCA - Scaling 2")
# Interpretation ####
# The Proportion of variance accounted for by the first two axes is 0.7375 or 73.8% This high value makes us confident
# that our interpretation of the first pair of axes extracts most relevant information from the data.
# First, the scaling 1 biplot displays a feature that must be explained. The circle is called a circle of equilibrium contribution. Its radius is equal to sqrt(d/p),
# where d is the number of axes represented in the biplot (usually d=2) and p is the number of dimensions of the PCA space (i.e. the number of variables of the data matrix,
#                                                                                                                          6 in this case)
# The radius of this circle represents the length of the vector representing a variable that contributes equally to all the dimanesions of the PCA space. Therefore,
# for any given pair of axis the variables that have vectors longer than this radius make a higher contribution than average and can be interpreted with confidence.
# The top right quarter of the biplot scaling 1 shows Microcosms with the highest values for pH, C and N content of the soil
# The scaling 2 biplot shows, that variables NO3 and nH4 are highly negatively correlated, as well as Cmic and No3. N, C and pH have nearly othogonal arrows indicating
# a correlation close to 0.
#####
cleanplot.pca(soil.pca, ahead=0)
plot(soil.pca, choices=c(ax1,ax2), display=c("wa","sp"), type="n",
main="PCA - scaling 1 (distance)", scaling=1)
plot(soil.pca, choices=c(ax1,ax2), display=c("wa","sp"), type="p",
main="PCA - scaling 1 (distance)", scaling=1)
plot(soil.pca, choices=c(ax1,ax2), display=c("wa","sp"),
main="PCA - scaling 1 (distance)", scaling=1)
source("Analysis/cleanplot.pca.R")
cleanplot.pca(soil.pca, ahead=0)
cleanplot.pca(soil.pca, ahead=0)
cleanplot.pca(soil.pca, ahead=0)
soil <- full.frame[,c(12,14:18)]
colnames(soil)[2:3] <- c("carbon","Nitrogen")
bio <- full.frame[,8:12]
env <- full.frame[,c(8:12,14:18)]
groups <- full.frame[,1:7]
for (i in 1:6) {
na.action=na.omit(soil)
soil[,i] <- soil[,i] + abs(min(soil[,i], na.rm=TRUE))
}
soil.log <- log1p(soil)
soil.z <- data.frame(scale(soil.log))
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Test for normal distribution ####
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
par(mfrow=c(3,4))
for (i in 1:6) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(3,4))
for (i in 1:6) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
summary(soil.z)
soil.mnorm <- t(soil.z)
mshapiro.test(soil.mnorm) # NO Normal Distribution!!!!!
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
soil.z[is.na(soil.z)] <- 0
# PCA
soil.pca <- rda(soil.z, scale=FALSE)
summary(soil.pca)
summary(soil.pca, scaling=1)
# Inertia: in vegan's language this is the term for "variation" in the data. This term comes from the word of CA (Sect. 5.4).
# In PCA, the "inertia" is either the sum of the variances of the variables (PCA on a covariance matrix) or the sum of the diagonal values
# of the correlation matrix (PCA on a correlation matrix), i.e. the sum of all correlations of the variables with themselves,
# which corresponds to the number of variables.
# Constrained and unconstrained (constrained = gezwungen, abhängig): In PCA the  analysis is unconstrained and so are the results.
# Eigenvalues: symbolized as lambda, these are measures of the importance of an axis. By dividing them by the total inertia, they can be expressed as
# Proportion explained / proportion of variation accounted for
# Scaling: 1 = distance biplot: the eigenvectors are scaled to unit length. (1) Distances among objects in the biplot are approximations
# of their Euclidean distances in multidimensional space. (2) The angles among descriptor vectors are meaningless
#          2 = correlation biplot: ech eigenvector is scaled to the squareroot of the eigenvalue. (1) Distances among objects are not
# approximations of their Euclidean distances in multidimensional space. (2) The angles between descriptors  in the biplot reflect their
# correlations
# Species scores: coordinates of the arrow heads of the variables. For historical rasons response variables are always calles "species" in vegan
# Site scores: coordinates of the sites in the ordination diagram. Objects are always called "Sites" in vegan output files.
# Loads of variables:
scores(soil.pca, choices = 1:4, display = "species", scaling = 0)
# Biplot
source("Analysis/evplot.R")
source("Analysis/cleanplot.pca.R")
eigenvalues <- soil.pca$CA$eig
evplot(eigenvalues) # One interprets only the axes whose eigenvalues are larger than the length of corresponding piece of the sticks
par(mfrow=c(1,2))
biplot(soil.pca, scaling=1,  main="PCA - Scaling 1")
pcacircle(soil.pca)
biplot(soil.pca, scaling=2,  main="PCA - Scaling 2")
# Interpretation ####
# The Proportion of variance accounted for by the first two axes is 0.7375 or 73.8% This high value makes us confident
# that our interpretation of the first pair of axes extracts most relevant information from the data.
# First, the scaling 1 biplot displays a feature that must be explained. The circle is called a circle of equilibrium contribution. Its radius is equal to sqrt(d/p),
# where d is the number of axes represented in the biplot (usually d=2) and p is the number of dimensions of the PCA space (i.e. the number of variables of the data matrix,
#                                                                                                                          6 in this case)
# The radius of this circle represents the length of the vector representing a variable that contributes equally to all the dimanesions of the PCA space. Therefore,
# for any given pair of axis the variables that have vectors longer than this radius make a higher contribution than average and can be interpreted with confidence.
# The top right quarter of the scaling 1 biplot shows Microcosms with the highest values for pH, C and N content of the soil
# Ther is a gradient from topleft to buttom right qarter, The gradient displays Microcosms with either high
# values for No3 (topleft) of high values of NH4 (buttomright). The buttom right Microcosms have the highest values for both cmic and NH4,
# And also the lowes values of NO3
# The scaling 2 biplot shows, that variables NO3 and nH4 are highly negatively correlated, as well as Cmic and No3. N, C and pH have nearly othogonal arrows indicating
# a correlation close to 0.
#####
cleanplot.pca(soil.pca, ahead=0)
source("Analysis/V2_RequiredPackages.R")
source("Data/V2_LoadData.R")
# Sample 11 has strange Cmic values
full.frame <- full.frame[-11,]
# Divide data frame in subsets ####
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
soil <- full.frame[,c(12,14:18)]
colnames(soil)[2:3] <- c("carbon","Nitrogen")
bio <- full.frame[,8:12]
env <- full.frame[,c(8:12,14:18)]
groups <- full.frame[,1:7]
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
View(soil)
soil.z <- data.frame(scale(soil))
View(soil.z)
View(soil)
View(soil.z)
par(mfrow=c(3,4))
for (i in 1:6) {
qqnorm(soil.z[,i], xlab=colnames(soil.z[i]))
qqline(soil.z[,i])
}
par(mfrow=c(3,4))
for (i in 1:6) {
hist(soil.z[,i], xlab=colnames(soil.z[i]))
}
summary(soil.z)
scatter.smooth(soil$NH4)
par(mfrow=c(1,1))
scatter.smooth(soil$NH4)
ggplot(soil, aes(NH4, 1)) + geom_points()
ggplot(soil, aes(NH4, 1)) + geom_point()
ggplot(soil, aes(NH4)) + geom_point()
ggplot(soil, aes(y=NH4)) + geom_point()
View(soil)
ggplot(soil, aes(y=NH4,row.names(soil))) + geom_point()
scatter.smooth(soil$NH4)
View(soil)
row.names(soil)
ggplot(soil, aes(y=NH4,c(1:82)) + geom_point()
soil.mnorm <- t(soil.z)
ggplot(soil, aes(y=NH4,c(1:82)) + geom_point()
ggplot(soil, aes(y=NH4,c(1:82))) + geom_point()
c(1:82)
ggplot(soil, aes(y=NH4,x=c(1:82))) + geom_point()
ggplot(soil, aes(y=NH4,x=c(1:79))) + geom_point()
scatter.smooth(soil$NH4)
ggplot(soil, aes(y=NH4,x=c(1:79), fill=soil)) + geom_point()
ggplot(full.frame, aes(y=NH4,x=c(1:79), fill=soil)) + geom_point()
ggplot(full.frame, aes(y=NH4,x=c(1:79))) + geom_point(fill=soil)
ggplot(full.frame, aes(y=NH4,x=c(1:79), col=soil)) + geom_point()
ggplot(full.frame, aes(y=NH4,x=c(1:79), col=soil, shape=Lt)) + geom_point()
ggplot(full.frame, aes(y=NH4,x=c(1:79), col=soil, shape=plant)) + geom_point()
ggplot(full.frame, aes(y=NH4,x=c(1:79), col=soil, shape=treat)) + geom_point()
ggplot(full.frame, aes(y=NH4,x=c(1:79), col=plant, shape=treat)) + geom_point()
ggplot(full.frame, aes(y=NH4,x=c(1:79), col=plant, shape=treat)) + geom_point(size=12)
ggplot(full.frame, aes(y=NH4,x=c(1:79), col=plant, shape=treat)) + geom_point(size=8)
soil.mnorm <- t(soil.z)
mshapiro.test(soil.mnorm) # NO Normal Distribution!!!!!
soil.log <- log1p(soil)
soil.z <- data.frame(scale(soil))
View(soil.z)
soil.z[is.na(soil.z)] <- 0
# PCA
soil.pca <- rda(soil.z, scale=FALSE)
summary(soil.pca)
summary(soil.pca, scaling=1)
scores(soil.pca, choices = 1:4, display = "species", scaling = 0)
# Biplot
source("Analysis/evplot.R")
source("Analysis/cleanplot.pca.R")
eigenvalues <- soil.pca$CA$eig
evplot(eigenvalues) # One interprets only the axes whose eigenvalues are larger than the length of corresponding piece of the sticks
cleanplot.pca(soil.pca, ahead=0)
par(mfrow=c(1,2))
biplot(soil.pca, scaling=1,  main="PCA - Scaling 1")
pcacircle(soil.pca)
biplot(soil.pca, scaling=2,  main="PCA - Scaling 2")
plot.cca(soil.pca)
?plot.cca()
source("Analysis/V2_RequiredPackages.R")
library("vegan", lib.loc="C:/Program Files/R/R-3.1.3/library")
plot.cca(soil.pca)
soil <- full.frame[,c(12,14:18)]
soil <- full.frame[,c(12,14:18)]
colnames(soil)[2:3] <- c("carbon","Nitrogen")
source("Data/V2_LoadData.R")
full.frame <- full.frame[-11,]
soil <- full.frame[,c(12,14:18)]
colnames(soil)[2:3] <- c("carbon","Nitrogen")
bio <- full.frame[,8:12]
env <- full.frame[,c(8:12,14:18)]
groups <- full.frame[,1:7]
soil.pca <- rda(soil.z, scale=TRUE)
summary(soil.pca) # scaling 2 by default
soil.pca <- rda(soil, scale=TRUE)
soil.pca <- rda(soil.z, scale=FALSE)
soil.z <- data.frame(scale(soil))
soil.pca <- rda(soil, scale=TRUE)
soil.pca2 <- rda(soil.z, scale=FALSE)
summary(soil.pca) # scaling 2 by default
summary(soil.pca2) # scaling 2 by default
summary(soil.pca, scaling=1)
summary(soil.pca2, scaling=1)
bio.pca <- rda(bio, scale=TRUE)
cleanplot.pca(bio.pca, ahead=0)
View(bio)
bio[is.na(bio)] <- 0
bio.pca <- rda(bio, scale=TRUE)
cleanplot.pca(bio.pca, ahead=0)
?ordiplot()
??ordiplot()
install.packages("FactoMineR")
install.packages("rgl")
library(FactoMineR)
source("Analysis/V2_RequiredPackages.R")
source("Data/V2_LoadData.R")
full.frame <- full.frame[-11,]
# Divide data frame in subsets ####
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
soil <- full.frame[,c(12,14:18)]
colnames(soil)[2:3] <- c("carbon","Nitrogen")
bio <- full.frame[,8:12]
env <- full.frame[,c(8:12,14:18)]
groups <- full.frame[,1:7]
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
PCA(bio)
library(rgl)
plotPCA <- function(x, nGroup) {
n <- ncol(x)
if(!(n %in% c(2,3))) { # check if 2d or 3d
stop("x must have either 2 or 3 columns")
}
fit <- hclust(dist(x), method="complete") # cluster
groups <- cutree(fit, k=nGroup)
if(n == 3) { # 3d plot
plot3d(x, col=groups, type="s", size=1, axes=F)
axes3d(edges=c("x--", "y--", "z"), lwd=3, axes.len=2, labels=FALSE)
grid3d("x")
grid3d("y")
grid3d("z")
} else { # 2d plot
maxes <- apply(abs(x), 2, max)
rangeX <- c(-maxes[1], maxes[1])
rangeY <- c(-maxes[2], maxes[2])
plot(x, col=groups, pch=19, xlab=colnames(x)[1], ylab=colnames(x)[2], xlim=rangeX, ylim=rangeY)
lines(c(0,0), rangeX*2)
lines(rangeY*2, c(0,0))
}
}
source("Analysis/V2_RequiredPackages.R")
source("Data/V2_LoadData.R")
# Sample 11 has strange Cmic values
full.frame <- full.frame[-11,]
# Divide data frame in subsets ####
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
soil <- full.frame[,c(12,14:18)]
colnames(soil)[2:3] <- c("carbon","Nitrogen")
bio <- full.frame[,8:12]
env <- full.frame[,c(8:12,14:18)]
groups <- full.frame[,1:7]
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
plotPCA(bio)
bio.pca <- prcomp(bio, scale=TRUE)
bio.pca <- prcomp(soil, scale=TRUE)
soil.pca <- prcomp(soil, scale=TRUE)
plotPCA(soil.pca)
fit <- hclust(dist(soil.pca$x[,1:2]), method="complete")
groups <- cutree(fit, k=4)
plotPCA(soil.pca,groups)
plotPCA(soil.pca$x[,1:2],groups)
fit <- hclust(dist(soil.pca$x[,1:2]), method="complete")
groups <- cutree(fit, k=4)
plotPCA(soil.pca$x[,1:2],groups)
plotPCA(soil.pca$x[,1:3],groups)
groups <- cutree(fit, k=2)
plotPCA(soil.pca$x[,1:3],groups)
plotPCA(soil.pca$x[,1:3],4)
groups <- cutree(fit, k=4)
plot(fit)
plot(groups)
plotPCA(soil.pca$x[,1:2],4)
plotPCA(soil.pca$x[,1:3],4)
bio[is.na(bio)] <- 0
View(bio)
View(soil)
phyto <- cbind(bio, soil[,2:6])
PCA(bio)
PCA(phyto)
phyto.pca <- rda(phyto, scale=TRUE)
par(mfrow=c(1,2))
p <- length(phyto.pca$CA$eig)
length(phyto.pca$CA$eig)
scores(phyto.pca, display="wa", scaling=1, choices=c(1:p))
scores(phyto.pca, display="sp", scaling=1, choices=c(1:p))
biplot(phyto.pca, choices=c(ax1, ax2), display=c("wa", "sp"), type="n",
main="PCA - scaling 1", scaling=1)
if (point)
{
points(sit.sc1[,ax1], sit.sc1[,ax2], pch=20)
text(phyto.pca, display="wa", choices=c(ax1, ax2), cex=cex, pos=3, scaling=1)
}
biplot(phyto.pca, choices=c(1, 2), display=c("wa", "sp"), type="n",
main="PCA - scaling 1", scaling=1)
points(sit.sc1[,1], sit.sc1[,1], pch=20)
sit.sc1 <- scores(phyto.pca, display="wa", scaling=1, choices=c(1:p))
spe.sc1 <- scores(phyto.pca, display="sp", scaling=1, choices=c(1:p))
points(sit.sc1[,1], sit.sc1[,1], pch=20)
text(phyto.pca, display="wa", choices=c(1, 2), cex=cex, pos=3, scaling=1)
text(phyto.pca, display="sp", choices=c(1, 2), cex=cex, pos=4,
col="red", scaling=1)
text(phyto.pca, display="sp", choices=c(1, 2), 0.7=0.7, pos=4,
text(phyto.pca, display="sp", choices=c(1, 2), 0.7=0.7, pos=4,
text(phyto.pca, display="sp", choices=c(1, 2), cex=0.7, pos=4,
col="red", scaling=1)
text(phyto.pca, display="wa", choices=c(1, 2), cex=0.7, pos=3, scaling=1)
arrows(0, 0, spe.sc1[,1], spe.sc1[,2], length=ahead, angle=20, col="red")
arrows(0, 0, spe.sc1[,1], spe.sc1[,2], length=0.07, angle=20, col="red")
pcacircle(phyto.pca)
arrows(0, 0, spe.sc1[,1], spe.sc1[,2], length=0.1, angle=20, col="red")
pcacircle(phyto.pca)
arrows(0, 0, spe.sc1[,1], spe.sc1[,2], length=0.1, angle=20, col="red")
arrows(0, 0, spe.sc1[,1], spe.sc1[,2], length=0.08, angle=20, col="red")
biplot(phyto.pca, choices=c(1, 2), display=c("wa", "sp"), type="n",
main="PCA - scaling 1", scaling=1)
points(sit.sc1[,1], sit.sc1[,1], pch=20)
text(phyto.pca, display="wa", choices=c(1, 2), cex=0.7, pos=3, scaling=1)
arrows(0, 0, spe.sc1[,1], spe.sc1[,2], length=0.08, angle=20, col="red")
pcacircle(phyto.pca)
biplot(phyto.pca, choices=c(1, 2), display=c("wa", "sp"), type="n",
main="PCA - scaling 1", scaling=1)
text(phyto.pca, display="wa", choices=c(1, 2), cex=0.7, pos=3, scaling=1)
arrows(0, 0, spe.sc1[,1], spe.sc1[,2], length=0.04, angle=20, col="red")
pcacircle(phyto.pca)
biplot(phyto.pca, choices=c(1, 2), display=c("wa", "sp"), type="n",
main="PCA - scaling 1", scaling=1)
text(phyto.pca, display="wa", choices=c(1, 2), cex=0.7, pos=3, scaling=1)
arrows(0, 0, spe.sc1[,1], spe.sc1[,2], length=0.2, angle=20, col="red")
pcacircle(phyto.pca)
biplot(phyto.pca, scaling=1)
pcacircle(phyto.pca)
biplot(phyto.pca, choices=c(1, 2), display=c("wa", "sp"), type="n",
main="PCA - scaling 1", scaling=1)
arrows(0, 0, spe.sc1[,1], spe.sc1[,2], length=0.2, angle=20, col="red")
pcacircle(phyto.pca)
biplot(phyto.pca, scaling=1)
biplot(phyto.pca, choices=c(1, 2), display=c("wa", "sp"), type="n",
pcacircle(phyto.pca)
pcacircle(phyto.pca)
biplot(phyto.pca, choices=c(1, 2), display=c("wa", "sp"), type="n",
main="PCA - scaling 1", scaling=1)
arrows(0, 0, spe.sc1[,1], spe.sc1[,2], length=0.07, angle=20, col="red")
pcacircle(phyto.pca)
biplot()
biplot
call(biplot)
methods(biplot)
getAnywhere(biplot.prcomp)
getAnywhere(biplot.default)
biplot(phyto.pca, choices=c(1,2),scaling=1)
pcacircle(phyto.pca)
biplot(phyto.pca, choices=c(1, 2), display=c("wa", "sp"), type="n",
main="PCA - scaling 1", scaling=1)
arrows(0, 0, spe.sc2[,1]*0.8, spe.sc2[,2]*0.8, length=ahead, angle=20, col="red")
arrows(0, 0, spe.sc1[,1]*0.8, spe.sc1[,2]*0.8, length=0.07, angle=20, col="red")
pcacircle(phyto.pca)
phyto.pca$sdev[choices]
choices = 1L:2L
phyto.pca$sdev[choices]
phyto.pca$sdev
phyto.pca$x
phyto.pca <- rda(phyto, scale=TRUE)
phyto.pca$x
scores <- phyto.pca$x
names(phyto.pca)
call(phyto.pca)
phyto.pca$call
PCA(phyto)
scores <- phyto.pca$x[,1]
phyto.pca <- rda(phyto, scale=TRUE)
scores <- phyto.pca$x[,1:2]
phyto.pca$x[,1:2]
phyto.pca
phyto.pca <- rda(phyto, scale=TRUE)
phyto.pca
rda(phyto, scale=TRUE)
phyto.pca <- vegan::rda(phyto, scale=TRUE)
vegan::rda(phyto, scale=TRUE)
phyto.pca <- vegan::rda(phyto)#, scale=TRUE)
vegan::rda(phyto)
vegan :: rda(phyto)
vegan::rda(phyto)
library("vegan", lib.loc="C:/Program Files/R/R-3.1.3/library")
vegan::rda(phyto)
?rda()
install.packages(c("ape", "blme", "boot", "chron", "cluster", "devtools", "effects", "evaluate", "formatR", "gdata", "gplots", "highr", "knitr", "labdsv", "lmtest", "lsmeans", "manipulate", "maptools", "markdown", "MASS", "Matrix", "mnormt", "MuMIn", "numDeriv", "pander", "permute", "plotrix", "plyr", "polyclip", "prettyR", "psych", "R.utils", "R2jags", "R2WinBUGS", "Rcpp", "RcppArmadillo", "RCurl", "repmis", "rmarkdown", "scales", "sem", "sp", "stabledist", "stringr", "survival", "timereg", "vcd", "vegan", "VGAM", "XML"))
source("Analysis/V2_RequiredPackages.R")
source("Data/V2_LoadData.R")
full.frame <- full.frame[-11,]
# Divide data frame in subsets ####
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
soil <- full.frame[,c(12,14:18)]
colnames(soil)[2:3] <- c("carbon","Nitrogen")
bio <- full.frame[,8:12]
env <- full.frame[,c(8:12,14:18)]
groups <- full.frame[,1:7]
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
